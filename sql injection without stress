nano pentest_script.py
vim pentest_script.py
import requests
from bs4 import BeautifulSoup
import nmap
import subprocess

def check_sql_injection(url):
    # Example for SQL injection testing
    payloads = ["' OR '1'='1", "' OR '1'='2"]
    for payload in payloads:
        full_url = f"{url}?id={payload}"
        response = requests.get(full_url)
        if "error" not in response.text.lower():
            print(f"Potential SQL Injection at {full_url}")

def scan_with_nmap(url):
    nm = nmap.PortScanner()
    nm.scan(url)
    for host in nm.all_hosts():
        print(f"Host : {host} ({nm[host].hostname()})")
        print(f"State : {nm[host].state()}")
        for proto in nm[host].all_protocols():
            print(f"Protocol : {proto}")
            lport = nm[host][proto].keys()
            for port in lport:
                print(f"port : {port}\tstate : {nm[host][proto][port]['state']}")

def run_owasp_zap(url):
    subprocess.run(["zap-cli", "quick-scan", "-s", "xss,sqli", url])

def main():
    url = input("Enter the website URL: ")
    check_sql_injection(url)
    scan_with_nmap(url)
    run_owasp_zap(url)

if __name__ == "__main__":
    main()
python pentest_script.py
